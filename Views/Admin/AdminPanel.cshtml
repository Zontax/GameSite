@using Microsoft.AspNetCore.Identity
@using GameSite.Data
@inject SignInManager<ApplicationUser> SignInManager
@model RoleModel
@{
    ViewData["Title"] = Resources.Resource.AdminPanel;
}

<h1>@Resources.Resource.AdminPanel</h1>

<ul>
    @foreach (ApplicationUser user in ViewBag.Users)
    {
        @if (user != null)
        {
            <li class="admin-user-block">
                <p><b>Email:</b> @user?.Email</p>
                <p><b>Name:</b> @user?.Name</p>
                @if (user.LockoutEnd.HasValue && user.LockoutEnd.Value > DateTimeOffset.Now)
                {
                    <p><b>@Resources.Resource.Status: </b>@Resources.Resource.Blocked @user.LockoutEnd.Value.ToString()</p>
                }
                else
                {
                    <p><b>@Resources.Resource.Status: </b>@Resources.Resource.NotBlocked</p>
                }
                <p>
                    <b>@Resources.Resource.Roles:</b>
                    @foreach (string role in await SignInManager.UserManager.GetRolesAsync(user))
                    {
                        <b> @role |</b>
                    }
                </p>
                <p><b>@Resources.Resource.RegistrationDate:</b> @user?.RegistrationDate</p>

                <form asp-controller="Admin" asp-action="ManageRole" method="post">

                    <input type="hidden" value="@user?.Id" name="userId" readonly hidden />
                    <label>@Resources.Resource.RoleName</label>
                    <input type="text" name="role" />
                    <span asp-validation-for="RoleName" class="text-danger"></span>
                    <button type="submit" class="btn btn-primary" name="submitType" value="Add">
                        @Resources.Resource.AssignARole</button>
                    <button type="submit" class="btn btn-warning" name="submitType" value="Remove">
                        @Resources.Resource.DeleteRole</button>
                    <button type="submit" class="btn btn-danger" name="submitType" value="Block">
                        @Resources.Resource.Block</button>
                    <button type="submit" class="btn btn-success" name="submitType" value="Unblock">
                        @Resources.Resource.Unblock</button>

                </form>

                <br>

            </li>
        }
    }
</ul>

@* <form method="post" action="">
<label>Назва ролі</label>
<input type="text" name="RoleName" />
<button type="submit" class="btn btn-primary" asp-page-handler="NewRole">Створити роль</button>
<button type="submit" class="btn btn-primary" asp-page-handler="AddRole">Назначити роль</button>
<button type="submit" class="btn btn-danger" asp-page-handler="RemoveRole">Видалити роль</button>
</form> *@